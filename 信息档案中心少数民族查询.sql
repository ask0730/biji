-- 查询2020.01.01在信息档案中心有主职记录的少数民族人员名称
SELECT DISTINCT 
    bd_psndoc.name as psnname,
    bd_defdoc_mz.name as nationality,
    T2.name as orgname,
    org_dept.name as deptname,
    case when T1.pk_postseries in ( '10011T100000000098AQ' , '10011T100000000098AT' , '10011T100000000098AU' , '10011T100000000098AV' , '10011T100000000098AW' , '10011T100000000098AX' , '10011T100000000098AY' , '10011T100000000098AZ' ) then '经营管理'
         when T1.pk_postseries in ( '10011T100000000098AR' , '10011T100000000098B0' , '10011T100000000098BB' , '10011T100000000098BP' , '10011T100000000098BQ' , '10011T100000000098BT' , '10011T100000000098BU' , '10011T100000000098BV' , '10011T100000000098BW' , '10011T100000000098BX' , '10011T100000000098BY' , '10011T100000000098BZ' , '10011T100000000098C0' , '10011T100000000098C1' , '10011T100000000098C2' , '10011T100000000098C3' , '10011T1000000000A73M' , '10011T100000000098B1' , '10011T100000000098C4' , '10011T100000000098C5' , '10011T100000000098C6' , '10011T100000000098C7' , '10011T100000000098CH' , '10011T100000000098CI' , '10011T100000000098CJ' , '10011T100000000098CK' , '10011T100000000098CL' , '10011T100000000098CM' , '10011T100000000098CN' , '10011T100000000098CO' , '10011T100000000098CP' , '10011T100000000098CQ' , '10011T100000000098CR' , '10011T100000000098CS' , '10011T100000000098CT' , '10011T100000000098CU' , '10011T100000000098DP' , '10011T100000000098DQ' , '10011T100000000098DR' , '10011T100000000098DS' , '10011T100000000098DT' , '10011T100000000098DU' , '10011T100000000098B7' , '10011T100000000098DV' , '10011T100000000098DW' , '10011T100000000098DX' , '10011T100000000098DY' , '10011T100000000098DZ' , '10011T100000000098E0' , '10011T100000000098E1' , '10011T100000000098E2' , '10011T100000000098E3' , '10011T100000000098BA' ) then '专业技术' 
         else '其他' end as postseries,
    T1.begindate as job_begindate,
    T1.enddate as job_enddate,
    hi_psnorg.begindate as org_begindate
FROM 
    bd_psndoc bd_psndoc 
    INNER JOIN hi_psnjob T1 
        ON T1.pk_psndoc = bd_psndoc.pk_psndoc 
    INNER JOIN hi_psnorg hi_psnorg
        ON hi_psnorg.pk_psndoc = bd_psndoc.pk_psndoc
    LEFT OUTER JOIN org_adminorg T2 
        ON T2.pk_adminorg = T1.pk_org 
    LEFT OUTER JOIN org_dept org_dept 
        ON org_dept.pk_dept = T1.pk_dept 
    LEFT OUTER JOIN bd_defdoc bd_defdoc_mz 
        ON bd_defdoc_mz.pk_defdoc = bd_psndoc.nationality
WHERE 
    1 = 1 
    -- 主职记录
    AND T1.ismainjob = 'Y'
    -- 在2020.01.01这一天有任职记录
    AND T1.begindate <= '2020-01-01' 
    AND NVL(T1.enddate, '2099-12-31') >= '2020-01-01'
    -- 少数民族（排除汉族）
    AND bd_defdoc_mz.name <> '汉族'
    AND bd_defdoc_mz.name IS NOT NULL
    -- 组织或部门名称包含"信息档案中心"
    AND (T2.name LIKE '%信息档案中心%' OR org_dept.name LIKE '%信息档案中心%')
ORDER BY 
    bd_psndoc.name

