//变量定义
Dim arr_输出数组,temp,hWeb,sRet

//变量赋值
arr_输出数组=Array([1,4],null)

//打开网页
TracePrint(str_数据抓取网站)
http_网址 = WebBrowser.Create("chrome",'''https://www.clcn.net.cn/resources/default/index?mode=external_link#selector-category-key''',30000,{"bContinueOnError":false,"iDelayAfter":300,"iDelayBefore":200,"sBrowserPath":'''''',"sStartArgs":""})
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"★★★★★★★★★★★★★★★★★★★★★★\n"+"["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  打开网页：【"+str_数据抓取网站+"】，抓取数据……"+"\n","utf-8")
//抓取第一页数据,并制作表头
arr_第一页数据 = UiElement.DataScrap({"wnd":[{"cls":"Chrome_WidgetWin_1","title":"*","app":"chrome"},{"cls":"Chrome_RenderWidgetHostHWND","title":"Chrome Legacy Window"}],"html":[{"tag":"DIV","id":"selector-category-key"}]},{"ExtractTable":0,"Columns":[{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-3 col-xs-12","value":"div.col-md-3.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"btn-wrap pull-right","value":"div.btn-wrap.pull-right","prefix":">"},{"tag":"a","index":2,"className":"btn btn-primary pull-left","value":"a:nth-child(2)","prefix":">"}],"props":["url"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"a","index":0,"className":"text-overflow2","value":"a.text-overflow2","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]}]},{"objNextLinkElement":'',"iMaxNumberOfPage":5,"iMaxNumberOfResult":-1,"iDelayBetweenMS":1000,"bContinueOnError":False})
arr_第一页数据 =Unshift(arr_第一页数据,["网址","名称","类型","状态"])
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  第一页数据抓取完毕……"+"\n","utf-8")
//抓取第二页数据
Mouse.Action(@ui"链接<a>_21","left","click",10000,{"bContinueOnError": false, "iDelayAfter": 3000, "iDelayBefore": 2000, "bSetForeground": true, "sCursorPosition": "Center", "iCursorOffsetX": 0, "iCursorOffsetY": 0, "sKeyModifiers": [],"sSimulate": "simulate", "bMoveSmoothly": false})
arr_第二页数据 = UiElement.DataScrap({"wnd":[{"cls":"Chrome_WidgetWin_1","title":"*","app":"chrome"},{"cls":"Chrome_RenderWidgetHostHWND","title":"Chrome Legacy Window"}],"html":[{"tag":"DIV","id":"selector-category-key"}]},{"ExtractTable":0,"Columns":[{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-3 col-xs-12","value":"div.col-md-3.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"btn-wrap pull-right","value":"div.btn-wrap.pull-right","prefix":">"},{"tag":"a","index":2,"className":"btn btn-primary pull-left","value":"a:nth-child(2)","prefix":">"}],"props":["url"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"a","index":0,"className":"text-overflow2","value":"a.text-overflow2","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]}]},{"objNextLinkElement":'',"iMaxNumberOfPage":5,"iMaxNumberOfResult":-1,"iDelayBetweenMS":1000,"bContinueOnError":False})
TracePrint($PrevResult)
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  第二页数据抓取完毕……"+"\n","utf-8")
//抓取第三页数据
Mouse.Action(@ui"链接<a>_3","left","click",10000,{"bContinueOnError": false, "iDelayAfter": 3000, "iDelayBefore": 2000, "bSetForeground": true, "sCursorPosition": "Center", "iCursorOffsetX": 0, "iCursorOffsetY": 0, "sKeyModifiers": [],"sSimulate": "simulate", "bMoveSmoothly": false})
arr_第三页数据 = UiElement.DataScrap({"wnd":[{"cls":"Chrome_WidgetWin_1","title":"*","app":"chrome"},{"cls":"Chrome_RenderWidgetHostHWND","title":"Chrome Legacy Window"}],"html":[{"tag":"DIV","id":"selector-category-key"}]},{"ExtractTable":0,"Columns":[{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-3 col-xs-12","value":"div.col-md-3.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"btn-wrap pull-right","value":"div.btn-wrap.pull-right","prefix":">"},{"tag":"a","index":2,"className":"btn btn-primary pull-left","value":"a:nth-child(2)","prefix":">"}],"props":["url"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"a","index":0,"className":"text-overflow2","value":"a.text-overflow2","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]},{"selecors":[{"tag":"div","index":0,"className":"column-main","value":"div.column-main","prefix":""},{"tag":"div","index":0,"className":"selector-main","value":"div.selector-main","prefix":">"},{"tag":"div","index":0,"className":"column-selector-list","value":"div.column-selector-list","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","value":"div","index":0,"prefix":">"},{"tag":"div","index":0,"className":"item item-cat","value":"div.item.item-cat","prefix":">"},{"tag":"div","index":0,"className":"row","value":"div.row","prefix":">"},{"tag":"div","index":0,"className":"col-md-4 col-xs-12","value":"div.col-md-4.col-xs-12","prefix":">"},{"tag":"div","index":0,"className":"title","value":"div.title","prefix":">"},{"tag":"div","index":0,"className":"label-trial","value":"div.label-trial","prefix":">"}],"props":["text"]}]},{"objNextLinkElement":'',"iMaxNumberOfPage":5,"iMaxNumberOfResult":-1,"iDelayBetweenMS":1000,"bContinueOnError":False})
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  全部数据抓取完毕。"+"\n","utf-8")
//数据合并
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  数据合并开始……"+"\n","utf-8")
arr_第一次合并数据=concat(arr_第一页数据,arr_第二页数据)
arr_最终数据=concat(arr_第一次合并数据,arr_第三页数据)
TracePrint($PrevResult)
File.Append(str_日志文件+"\\"+str_日期+".log","["+Time.Format(Time.Now(),"yyyy-mm-dd hh:mm:ss")+"]："+"状   态：  数据合并完毕。"+"\n","utf-8")

