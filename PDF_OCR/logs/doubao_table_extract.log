2025-11-24 15:18:59,723 - INFO - 开始处理文件: D:\Desktop\biji\wendang\职称参评-毛雅君20251114V1.0(1).pdf
2025-11-24 15:25:00,230 - INFO - 从HTML表格提取了 19 行数据
2025-11-24 15:25:00,285 - INFO - 成功映射 19 条数据到模板格式
2025-11-24 15:25:00,525 - ERROR - 保存模板格式Excel失败: File is not a zip file
2025-11-24 15:25:00,527 - ERROR - Traceback (most recent call last):
  File "D:\Desktop\biji\wendang\send_to_doubao_extract_table.py", line 957, in save_to_template_format
    wb = load_workbook(output_path)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\openpyxl\reader\excel.py", line 344, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

2025-11-24 15:25:00,528 - WARNING - 表格数据映射到模板失败: File is not a zip file
2025-11-24 15:25:00,615 - INFO - 表格已保存到: D:\Desktop\biji\wendang\人员信息_20251124_152500.xlsx, 共 19 行, 73 列
2025-11-24 15:30:11,357 - INFO - 开始处理文件: D:\Desktop\biji\wendang\职称参评-毛雅君20251114V1.0(1).pdf
2025-11-24 15:32:47,532 - ERROR - 发送消息失败: Message: stale element reference: stale element not found in the current frame
  (Session info: chrome=142.0.7444.163); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#staleelementreferenceexception
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0x7ff7247aa235
	0x7ff724502630
	0x7ff7242916dd
	0x7ff7242994c8
	0x7ff72429c52f
	0x7ff72429c5ef
	0x7ff7242eb23a
	0x7ff7242eb317
	0x7ff7242e0b5c
	0x7ff724312b0a
	0x7ff7242dcc36
	0x7ff72433baba
	0x7ff7242db0ed
	0x7ff7242dbf63
	0x7ff7247d5d60
	0x7ff7247cfe8a
	0x7ff7247f1005
	0x7ff72451d71e
	0x7ff724524e1f
	0x7ff72450b7c4
	0x7ff72450b97f
	0x7ff7244f18e8
	0x7ffe8fca7374
	0x7ffe91cbcc91

2025-11-24 15:32:47,533 - ERROR - 处理失败: Message: stale element reference: stale element not found in the current frame
  (Session info: chrome=142.0.7444.163); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#staleelementreferenceexception
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0x7ff7247aa235
	0x7ff724502630
	0x7ff7242916dd
	0x7ff7242994c8
	0x7ff72429c52f
	0x7ff72429c5ef
	0x7ff7242eb23a
	0x7ff7242eb317
	0x7ff7242e0b5c
	0x7ff724312b0a
	0x7ff7242dcc36
	0x7ff72433baba
	0x7ff7242db0ed
	0x7ff7242dbf63
	0x7ff7247d5d60
	0x7ff7247cfe8a
	0x7ff7247f1005
	0x7ff72451d71e
	0x7ff724524e1f
	0x7ff72450b7c4
	0x7ff72450b97f
	0x7ff7244f18e8
	0x7ffe8fca7374
	0x7ffe91cbcc91

2025-11-24 15:32:47,535 - ERROR - Traceback (most recent call last):
  File "D:\Desktop\biji\wendang\send_to_doubao_extract_table.py", line 1183, in main
    send_message_to_doubao(driver, message)
  File "D:\Desktop\biji\wendang\send_to_doubao_extract_table.py", line 311, in send_message_to_doubao
    input_element.send_keys(Keys.RETURN)
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\selenium\webdriver\remote\webelement.py", line 304, in send_keys
    self._execute(
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\selenium\webdriver\remote\webelement.py", line 573, in _execute
    return self._parent.execute(command, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\selenium\webdriver\remote\webdriver.py", line 458, in execute
    self.error_handler.check_response(response)
  File "C:\Users\User\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\selenium\webdriver\remote\errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: stale element not found in the current frame
  (Session info: chrome=142.0.7444.163); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#staleelementreferenceexception
Stacktrace:
Symbols not available. Dumping unresolved backtrace:
	0x7ff7247aa235
	0x7ff724502630
	0x7ff7242916dd
	0x7ff7242994c8
	0x7ff72429c52f
	0x7ff72429c5ef
	0x7ff7242eb23a
	0x7ff7242eb317
	0x7ff7242e0b5c
	0x7ff724312b0a
	0x7ff7242dcc36
	0x7ff72433baba
	0x7ff7242db0ed
	0x7ff7242dbf63
	0x7ff7247d5d60
	0x7ff7247cfe8a
	0x7ff7247f1005
	0x7ff72451d71e
	0x7ff724524e1f
	0x7ff72450b7c4
	0x7ff72450b97f
	0x7ff7244f18e8
	0x7ffe8fca7374
	0x7ffe91cbcc91


2025-11-24 15:32:58,024 - INFO - 开始处理文件: D:\Desktop\biji\wendang\职称参评-毛雅君20251114V1.0(1).pdf
